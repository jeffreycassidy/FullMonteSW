ifndef SOURCE_ROOT
	SOURCE_ROOT=/home/jcassidy
endif

ifndef LIB_ROOT
	LIB_ROOT=$(SOURCE_ROOT)/FullMonte
endif

ifndef BOOST_INCLUDE
	BOOST_INCLUDE=/usr/local/include/boost
endif

ifndef BOOST_LIB 
	BOOST_LIB=/usr/local/lib/boost
endif

ifndef VTK_INCLUDE
	VTK_INCLUDE=/usr/local/include/vtk
endif

ifndef VTK_LIB
	VTK_LIB=/usr/local/vtk/lib
endif

ifndef CXX
	CXX=g++
endif

ifndef SWIG
	SWIG=swig3.0
endif


ifndef ANTLR_DIR
	ANTLR_DIR=/usr/local/antlr3c-3.4
endif

ifndef ANTLR_INCLUDE
	ANTLR_INCLUDE=$(ANTLR_DIR)/include
endif

ifndef ANTLR_LIB
	ANTLR_LIB=$(ANTLR_DIR)/lib
endif

ifndef ANTLR
    ANTLR=java -jar /usr/local/antlr-3.5.2-complete.jar
endif

ifndef TCL_LIB
    TCL_LIB=/usr/lib/x86_64-linux-gnu/libtclstub8.5.a
endif


ifndef TCL_INCLUDE 
	TCL_INCLUDE=/usr/include/tcl8.5
endif

CXX_OPTS=-Wall -std=c++11 -O3 -g -Wno-missing-braces  -msse4 -mavx -fPIC -fabi-version=6 -I$(SOURCE_ROOT) -L$(LIB_ROOT)  -I$(ANTLR_INCLUDE) -I$(BOOST_INCLUDE) -Wa,-q

CXX_LIB_OPTS=-Wall -fabi-version=6 -msse4 -mavx -fPIC -shared -L$(LIB_ROOT) -Wa,-q

%.o: %.cpp *.hpp
	$(CXX) $(CXX_OPTS) -c $<
	
%_wrap.cxx: %.i
	$(SWIG) -c++ -tcl $<
	
%_wrap.cxx: %.hpp
	$(SWIG) -c++ -tcl $<
	
%_wrap.o: %_wrap.cxx
	$(CXX) $(CXX_OPTS) -I$(TCL_INCLUDE) -c -DUSE_TCL_STUBS $<
	
lib%_TCL.so: %_wrap.o lib%.so
	$(CXX) $(CXX_LIB_OPTS) -L. -l$* -o $@ $<

libFullMonte%_TCL.so: %_wrap.o libFullMonte%.so
	$(CXX) $(CXX_LIB_OPTS) -L. -l$* -o $@ $<

defaultclean:
	rm -rf *.so *.a *_wrap.cxx *.o
	
# allow each folder to override the make clean command
clean:
	rm -rf *.so *.a *_wrap.cxx *.o a.out
	
