CXX_OPTS=-Wall -std=c++11 -O3 -fPIC -g -mavx -Wa,-q
CXX=g++

include ../../Makefile.in


%_tokens.h: %.tokens

	cat $^ | $(SOURCE_ROOT)/FullMonte/Storage/CommonParser/mktok.pl > $@

%Parser.c %Lexer.c %Parser.h %Lexer.h %.tokens: %.g
	$(ANTLR) $^
	
%Parser.o: %Parser.c %Parser.h
	$(CXX) $(CXX_OPTS) -Wno-unused-variable -Wno-unused-but-set-variable -Wno-unused-function -I$(ANTLR_INCLUDE) -D_empty=NULL -c $*Parser.c 
	
%Lexer.o: %Lexer.c %Lexer.h
	$(CXX) $(CXX_OPTS) -Wno-unused-variable -Wno-unused-but-set-variable -Wno-unused-function -I$(ANTLR_INCLUDE) -D_empty=NULL -c $*Lexer.c
	
parser-clean:
	rm -f *Parser.h *Parser.c *Lexer.c *Lexer.h *_tokens.h *.tokens *Parser.o *Lexer.o

clean: parser-clean
